{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'xptracker/style.css' %}" />

<h3>Developers</h3>
{% if developer_list %}
    <ul>
    {% for developer in developer_list %}
        <li><a href={% url "xptracker:developer_detail" developer.id %}>{{ developer.name }}</a></li>
    {% endfor %}
    </ul>
{% else %}
    <p>No developers exist.</p>
{% endif %}

<h3>Stories</h3>
{% if story_list %}
<table>
    <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Time estimate</th>
        <th>Time actual</th>
    </tr>
    {% for story in story_list %}
    <tr>
        <td>{{ story.name }}<br/>
            <a href={% url "xptracker:story_update" story.id %}>Edit</a>|
            <a href={% url "xptracker:story_delete" story.id %}>Delete</a>
        </td>
        <td>{{ story.description }}</td>
        <td>{{ story.time_hours_estimate }}</td>
        <td>{{ story.time_hours_actual }}</td>
    </tr>
    {% endfor %}
    <tr>
        <td/>
        <td id="totals-label-cell"><b>Totals:</b></td>
        <td>{{ total_story_time_estimate }}</td>
        <td>{{ total_task_time_actual }}</td>
    </tr>
</table>
{% else %}
    <p>No stories exist.</p>
{% endif %}

<a href={% url "xptracker:story_create" %}>Create new story</a>

<h3>Tasks</h3>
{% if task_list %}
<table>
    <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Developer</th>
        <th>Iteration</th>
        <th>Completed?</th>
        <th>Time estimate</th>
        <th>Time actual</th>
        <th>Add work</th>
    </tr>
    {% for task in task_list %}
    <tr>
        <td>{{ task.name }}<br/>
            <a href={% url "xptracker:task_update" task.id %}>Edit</a>|
            <a href={% url "xptracker:task_delete" task.id %}>Delete</a>
        </td>
        <td>{{ task.description }}</td>
        <td>{{ task.developer }}</td>
        <td>{{ task.iteration }}</td>
        <td>{{ task.completed }}</td>
        <td>{{ task.time_hours_estimate }}</td>
        <td>{{ task.total_work }}</td>
        <td><a href={% url "xptracker:work_create" task.id %}>++</a></td>
    </tr>
    {% endfor %}
    <tr>
        <td/>
        <td/>
        <td/>
        <td/>
        <td id="totals-label-cell"><b>Totals:</b></td>
        <td>{{ total_task_time_estimate }}</td>
        <td>{{ total_task_time_actual }}</td>
    </tr>
<table>
{% else %}
    <p>No tasks exist.</p>
{% endif %}

<a href={% url "xptracker:task_create" %}>Create new task</a><br />

<h3>Iterations with respective stories and tasks</h3>
{% if iteration_list %}
    <ul>
    {% for iteration in iteration_list %}
        <li>{{ iteration.name }}</li>
        <ul>
        {% for story in iteration.story_set.all %}
            <li>{{ story.name }}</li>
            <ul>
            {% for task in story.task_set.all %}
                <li>{{ task.name }}</li>
            {% endfor %}
            </ul>
        {% endfor %}
        </ul>
    {% endfor %}
    </ul>
{% else %}
    <p>No iterations exist.</p>
{% endif %}

<a href={% url "xptracker:iteration_create" %}>Create new iteration</a>

<!-- <h3>Incomplete tasks</h3>
{% for task in incomplete_task_list %}
    <p>{{ task }}</p>
{% endfor %} -->
